<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>E-LegalBoom | Intake Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Your existing CSS -->
  <link rel="stylesheet" href="style.css" />

  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    /* ==============================
       ðŸ”´ INSERT YOUR REAL VALUES
       ============================== */
    const SUPABASE_URL = "https://vvjbjfltqsivvxxifnvi.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ2amJqZmx0cXNpdnZ4eGlmbnZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5NzYzNTAsImV4cCI6MjA3MzU1MjM1MH0.F4zzcpCHl9v-Rnj0wgKJ5zBf1HteVyXelMLQDDEN28Q";

    const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  </script>
</head>
<body>

<header class="site-header">
  <div class="logo-area">
    <h1>E-LegalBoom</h1>
    <p>Your Legal Documents, Built Right</p>
  </div>
  <nav class="main-nav">
    <a href="index.html">Home</a>
    <a href="catalog.html">Catalog</a>
    <a href="bundle.html">Bundles</a>
  </nav>
</header>

<main class="page-content">

  <section class="form-intro">
    <h2>Document Intake</h2>
    <p>
      Please complete the form below. Your answers will be used
      to generate your legal document framework.
    </p>
  </section>

  <section class="form-section">
    <form id="intake-form">

      <!-- âœ… WHICH DOCUMENT THE USER CHOSE -->
      <input type="hidden" id="doc_type" name="doc_type">

      <!-- CUSTOMER INFO -->
      <label>
        Full Name
        <input type="text" name="customer_name" required>
      </label>

      <label>
        Email Address
        <input type="email" name="customer_email" required>
      </label>

      <label>
        Phone (optional)
        <input type="text" name="customer_phone">
      </label>

      <!-- ENTITY TYPE -->
      <label>
        Entity Type
        <select name="entity_type" required>
          <option value="">Select one...</option>
          <option value="individual">Individual</option>
          <option value="llc">LLC</option>
          <option value="corporation">Corporation</option>
          <option value="partnership">Partnership</option>
          <option value="trust">Trust</option>
        </select>
      </label>

      <!-- GOVERNING STATE -->
      <label>
        Governing State
        <select name="governing_state" required>
          <option value="">Select state...</option>
          <option>Alabama</option><option>Alaska</option><option>Arizona</option>
          <option>Arkansas</option><option>California</option><option>Colorado</option>
          <option>Connecticut</option><option>Delaware</option><option>Florida</option>
          <option>Georgia</option><option>Hawaii</option><option>Idaho</option>
          <option>Illinois</option><option>Indiana</option><option>Iowa</option>
          <option>Kansas</option><option>Kentucky</option><option>Louisiana</option>
          <option>Maine</option><option>Maryland</option><option>Massachusetts</option>
          <option>Michigan</option><option>Minnesota</option><option>Mississippi</option>
          <option>Missouri</option><option>Montana</option><option>Nebraska</option>
          <option>Nevada</option><option>New Hampshire</option><option>New Jersey</option>
          <option>New Mexico</option><option>New York</option><option>North Carolina</option>
          <option>North Dakota</option><option>Ohio</option><option>Oklahoma</option>
          <option>Oregon</option><option>Pennsylvania</option><option>Rhode Island</option>
          <option>South Carolina</option><option>South Dakota</option><option>Tennessee</option>
          <option>Texas</option><option>Utah</option><option>Vermont</option>
          <option>Virginia</option><option>Washington</option><option>West Virginia</option>
          <option>Wisconsin</option><option>Wyoming</option>
        </select>
      </label>

      <!-- BUSINESS / TRUST DETAILS -->
      <label>
        Business / Trust / Entity Name
        <input type="text" name="entity_name">
      </label>

      <label>
        Names of Other Parties / Members / Trustees / Partners (comma-separated)
        <textarea name="other_parties" rows="3"></textarea>
      </label>

      <!-- FLEX FIELD (works for most docs) -->
      <label>
        Special Instructions or Notes
        <textarea name="special_notes" rows="4"></textarea>
      </label>

      <!-- AGREEMENTS -->
      <label class="checkbox">
        <input type="checkbox" required>
        I confirm that the information provided is accurate to the best of my knowledge.
      </label>

      <label class="checkbox">
        <input type="checkbox" required>
        I understand this is not legal advice and no attorney-client relationship is created.
      </label>

      <!-- SUBMIT -->
      <button type="submit" class="btn-primary">
        Submit & Continue to Payment
      </button>

    </form>
  </section>
</main>

<footer class="site-footer">
  <p>&copy; 2025 E-LegalBoom. All rights reserved.</p>
</footer>

<!-- ===========================
     SCRIPT SECTION
     =========================== -->
<script>

  /* âœ… Capture the document type from catalog.html (via ?doc_type=) */
  const params = new URLSearchParams(window.location.search);
  const docType = params.get("doc_type");
  if (docType) {
    document.getElementById("doc_type").value = docType;
  }

  /* âœ… Submit to Supabase */
  const form = document.getElementById("intake-form");

  form.addEventListener("submit", async function(e) {
    e.preventDefault();

    const formData = new FormData(form);
    const payload = Object.fromEntries(formData.entries());

    const { data, error } = await supabase
      .from("document_requests")
      .insert([{
        doc_type: payload.doc_type || "unspecified",
        customer_name: payload.customer_name,
        customer_email: payload.customer_email,
        governing_state: payload.governing_state,
        entity_type: payload.entity_type,
        data: payload
      }]);

    if (error) {
      alert("There was an error submitting your intake. Please try again.");
      console.error("Supabase error:", error);
      return;
    }

    /* âœ… Redirect to payment */
    window.location.href = "payment.html";
  });

</script>

</body>
</html>
